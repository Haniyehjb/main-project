#include <stdio.h>
#include <stdbool.h>
#include <windows.h> 
#include <time.h>
#include <conio.h> 

void gotoxy(int x, int y) {
    COORD coord;
    coord.X = x;
    coord.Y = y;
    SetConsoleCursorPosition(GetStdHandle(STD_OUTPUT_HANDLE), coord);

}
// تابع برای حرکت کاراکتر
void move_character(int *i, int *j, char ch, char mat[][128]) {
    gotoxy(*j*2 ,*i);
    mat[*i][*j] = ' ';
    
    // حرکت کاراکتر بر اساس ورودی کاربر
    if (ch == 'd' && *j < 127 && (mat[*i][*j + 1] == ' ' || mat[*i][*j + 1] == 8 || mat[*i][*j + 1] == 9 || mat[*i][*j + 1] == 3 || mat[*i][*j + 1] == '#')) {
        (*j)++;  // حرکت به راست
    } else if (ch == 'a' && *j > 0 && (mat[*i][*j - 1] == ' ' || mat[*i][*j - 1] == 8 || mat[*i][*j - 1] == 9 || mat[*i][*j - 1] == 3 || mat[*i][*j - 1] == '#')) {
        (*j)--;  // حرکت به چپ
    } else if (ch == 's' && *i < 13 && (mat[*i + 1][*j] == ' ' || mat[*i + 1][*j] == 8 || mat[*i + 1][*j] == 9 || mat[*i + 1][*j] == 3 || mat[*i + 1][*j] == '#')) {
        (*i)++;  // حرکت به پایین
    } else if (ch == 'w' && *i > 0 && (mat[*i - 1][*j] == ' ' || mat[*i - 1][*j] == 8 || mat[*i - 1][*j] == 9 || mat[*i - 1][*j] == 3 || mat[*i - 1][*j] == '#')) {
        (*i)--;  // حرکت به بالا
    } 
    

    // قرار دادن کاراکتر در موقعیت جدید
    mat[*i][*j] = '#';
}



// تابع برای چاپ شبکه (همان‌طور که قبلاً تعریف شده است)
void print_grid(char mat[][128]) {
    for (int i = 0; i < 14; ++i) {
        for (int j = 0; j < 128; ++j) {
            if (mat[i][j] == 1) {
                printf("🧱");  // دیوار
            } else if (mat[i][j] == 2) {
                printf("🟩");  // چمن
            } else if (mat[i][j] == 3) {
                printf("🪙 ");  // سکه
            } else if (mat[i][j] == 4) {
                printf("🌱");  // گیاه
            } else if (mat[i][j] == 6) {
                printf("🟪");  // بنفش
            } else if (mat[i][j] == 5) {
                printf(" 🐙");  // اختاپوس
            } else if (mat[i][j] == 7) {
                printf("🦖");  // دایناسور
            } else if (mat[i][j] == 8) {
                printf("🟧");  // نارنجی
            } else if (mat[i][j] == 9) {
                printf("🟨");  // زرد
            } else if (mat[i][j] == '!') {
                printf("🚩");  // پرچم
            } else if (mat[i][j] == '#') {
                printf("🥸");  // کاراکتر اصلی
            } else if (mat[i][j] == ' ') {
                printf("  ");  // فضای خالی
            }
        }
        printf("\n");  // رفتن به خط بعدی پس از چاپ هر سطر
    }
}

int main() {
    // تعریف شبکه (همان‌طور که قبلاً تعریف شده است)
    char mat[14][128] = {
        {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2, 2, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2, 2, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2, 2, 2, 2, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 4, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ' ,' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', '!', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3, 3, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, 6, 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, 1, 1, ' ', ' ', ' ', ' ', ' ', ' ', 1, 1, 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, 1, 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, 6, 6, ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', 1, 1, 1, ' ', 3, 3, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 4, ' ', ' ', 6, ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, 1, 9, 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',6, 6, 6, ' ', 6, ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, 8, 8, 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, 1, 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, ' ', ' ', 6, ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, ' ', ' ', 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2, 2, 2, 1},
        {1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ',6, 6, 6, ' ', 6, ' ', ' ', 6, ' ', ' ', 6, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 1, ' ', ' ', 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 2, ' ', 1},
        {1, ' ', '#', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', 3, 3, ' ', ' ', ' ', ' ', ' ',5,' ', ' ', ' ', ' ', ' ', ' ', ' ', 6, ' ', 7, 6, ' ' ,7, 6, ' ', 7, 6, ' ', 7, ' ', ' ',' ', ' ', ' ', 1, ' ', ' ', ' ', ' ', ' ', ' ', ' ', 5, 5, ' ', 2, ' ' , 1},
        {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}
    };
    
    int char_i = 12, char_j = 2;  // موقعیت اولیه کاراکتر
    
    print_grid(mat);  // چاپ اولیه شبکه

    char input;
  while (1) {
        
        if (_kbhit()) { // بررسی آیا کلیدی فشار داده شده است یا خیر
            input = _getch(); // گرفتن کاراکتر بدون نمایش آن در صفحه
        move_character(&char_i, &char_j, input, mat);  // حرکت کاراکتر
        
        print_grid(mat);  // چاپ شبکه پس از حرکت
        Sleep(500);  // تاخیر برای مشاهده بهتر حرکت
    }
    }

    return 0;
}